<?xml version="1.0" encoding="utf-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Fragment>
    <DirectoryRef Id="INSTALLDIR">
        <Component Id="FirezoneClientIpcService" Guid="a8092ff9-30fa-48bb-9b2d-45fe39d16c66">
          <File Id="FirezoneClientIpcServiceExe" Name="firezone-client-ipc.exe" Source="../../firezone-client-ipc.exe" KeyPath="yes" />

          <ServiceControl Id="RemoveOldFirezoneService" Name="FirezoneClientIpcService" Stop="uninstall" Remove="uninstall" Wait="yes" />
          <ServiceControl Id="RemoveOldFirezoneDebugService" Name="FirezoneClientIpcServiceDebug" Stop="uninstall" Remove="uninstall" Wait="yes" />
        </Component>

        <Component Id="FirezoneClientTunnelService" Guid="2c808b80-a2f2-4d2a-9563-1706cf72e040">
          <File Id="FirezoneClientTunnelServiceExe" Name="firezone-client-tunnel.exe" Source="../../firezone-client-tunnel.exe" KeyPath="yes" />

          <ServiceInstall
              Id="FirezoneClientTunnelServiceInstaller"
              Arguments="run"
              Type="ownProcess"
              Vital="yes"
              Name="FirezoneClientTunnelService"
              DisplayName="Firezone Tunnel Service"
              Start="auto"
              Account="LocalSystem"
              ErrorControl="normal"
              Interactive="no">
            </ServiceInstall>

            <ServiceControl Id="FirezoneClientTunnelServiceControl" Start="install" Stop="both" Remove="both" Name="FirezoneClientTunnelService" Wait="yes" />
        </Component>
    </DirectoryRef>
  </Fragment>
</Wix>
